---
layout: post
title: 15단계로 배우는 쿠버네티스 스터디 2장
subtitle: ''
categories: devops
tags: k8s
comments: false
---

## 2장 컨테이너의 이해

### 쿠버네티스를 위해 알아둬야할 도커 지식

- 일반적인 배포 상황에서 애플리케이션을 빌드할 때 마다 다른 라이브러리를 사용하게 될 가능성이 있다.

- 오픈 소스 라이브러리의 사용은 개발 생산성을 높이지만 소프트웨어의 안정성을 유지하기는 어렵다. (버전이 올라가서 특정 기능이 동작하지 않는다던가 하는 상황)

- 도커는 이러한 문제를 컨테이너를 통해 해결하였다.

- 도커와 관련된 기초 지식 중 k8s를 위해 필요한 부분을 중점적으로 살펴보자

## 컨테이너를 사용하는 이유

컨테이너를 사용하는 이유는 다음과 같다.

### 1. 인프라의 사용률 향상

- 하나의 물리 서버나 가상 서버 위에 여러 컨테이너를 운영할 수 있다.

- CPU와 메모리 사용률을 높여 하드웨어를 효율적으로 운영할 수 있다.

### 2. 빠른 기동 시간

- 컨테이너의 기동 시간은 가상 서버나 물리 서버의 기동 시간보다 훨씬 빠르다.

- OS, Application, middleware 등 다양한 이미지를 손쉽게 얻을 수 있다.

- 설치 작업과 설정 작업이 줄어든다.

- 네트워크, 볼륨(외부 저장)을 소프트웨어 정의 오브젝트로 작성할 수 있다.

### 3. 불변 실행 환경

- 애플리케이션 실행에 필요한 소프트웨어를 모두 포함하여 컨테이너를 작성할 수 있다.

- 개발 환경과 운영 환경의 차이를 줄일 수 있다.

- 컨테이너를 조합하여 시스템을 구성함으로써 특정 서버 환경에 대한 종속성을 없앨 수 있다.

## 가상서버와 컨테이너의 차이점

- 가상 서버는 한 대의 머신 위에서 여러 대의 가상 서버를 구동할 수 있다.

- 가상 서버 구동 시간은 직접 돌려보면 알겠지만 엄청 느리다.

- 가상화 소프트웨어를 Hypervisor라 부르며 VMware, VirtualBox등이 있다.

- 컨테이너는 하나의 리눅스 프로세서가 마치 전용 서버에서 동작하듯이 분리한다.

- 이는 리눅스 커널의 네임스페이스와 컨트롤 그룹(cgroup)이라는 기술을 기반으로 한다.

![containers-101](https://user-images.githubusercontent.com/43809168/101057323-43630f80-35cf-11eb-973b-3a3ea564a4a1.png)

[출처 : 구글 클라우드](https://cloud.google.com/containers/?hl=ko)

컨테이너와 가상서버를 수치적으로 비교하면 아래와 같다.

| 특징                         | 가상서버                    | 컨테이너    |
| ---------------------------- | --------------------------- | ----------- |
| 이미지 크기(CentOS 7.4 기준) | 최소 1.54GB                 | 최소 0.20GB |
| 메모리 사용량                | 기본 640MB                  | 기본 512MB  |
| 벤치 마크 성능 비교          | 65%(Xen HVM 가상 서버 기준) | 90%         |
| OS 기동 시간                 | 분 단위                     | 초 단위     |

Window나 Mac에서 컨테이너를 돌리려면 리눅스 커널을 필요한데 이를 위한 가상 서버가 필요하다.

`Docker CE`(Community Edition 18.06 이후)를 Mac이나 Window에서 구동하기 위해선 각각의 하이퍼바이저 위에서 `LinuxKit`이 기동하며 그 위에서 컨테이너의 런타임인 `containerd`가 기동한다.

Window 10에서는 `Hyper-V`(가상화 시스템 이름)를 사용하며 Mac에서는 Hypervisor framework를 기반으로 한 `HyperKit`을 사용한다.

`LinuxKit`은 컨테이너를 실행하기 위한 경량의 리눅스 서브시스템으로 도커,IBM,리눅스 파운데이션,마이크로소프트,ARM,휴렛 패커드, 인텔과 같이 이름 들으면 다 알법한 회사들이 만들었다.

가까운 미래에는 `LinuxKit`으로 표준화된 리눅스 커널을 통해 애플리케이션이 컨테이너 위에서 실행되는 것이 당연한 시대가 이미 왔다고 해도 과언이 아니다.

<img width="1609" alt="스크린샷 2020-12-04 오전 1 39 13" src="https://user-images.githubusercontent.com/43809168/101059360-8625e700-35d1-11eb-8a10-b68316385242.png">

[ 가상 서버 위에 Docker를 구동하면 보안에 더 안전하다는 장점이 있다. ]

## Reference

![k8s](https://user-images.githubusercontent.com/43809168/101032998-6684c380-35bd-11eb-8ba7-a784fd46b37a.png)

### 15단계로 배우는 도커와 쿠버네티스 - 타카라 마호 저서
